define(["require","exports","module","jquery"],function(e,t,n){function o(e,t,n){t=t||"",n=n||512;var r=atob(e),i=[];for(var s=0;s<r.length;s+=n){var o=r.slice(s,s+n),u=new Array(o.length);for(var a=0;a<o.length;a++)u[a]=o.charCodeAt(a);var f=new Uint8Array(u);i.push(f)}return new Blob(i,{type:t})}var r=e("jquery"),i,s="audio/wav";i={recorder:null,recorderOriginalWidth:0,recorderOriginalHeight:0,uploadFormId:null,uploadFieldName:null,isReady:!1,connect:function(e,t){navigator.appName.indexOf("Microsoft")!=-1?i.recorder=window[e]:i.recorder=document[e];if(t>=45)return;if(i.recorder&&i.recorder.init){i.recorderOriginalWidth=i.recorder.width,i.recorderOriginalHeight=i.recorder.height;if(i.uploadFormId&&r){var n=r(i.uploadFormId);i.recorder.init(n.attr("action").toString(),i.uploadFieldName,n.serializeArray())}return}setTimeout(function(){i.connect(e,t+1)},100)},playBack:function(e){i.recorder.playBack(e)},pausePlayBack:function(e){i.recorder.pausePlayBack(e)},playBackFrom:function(e,t){i.recorder.playBackFrom(e,t)},record:function(e,t){try{i.recorder.record(e,t)}catch(n){typeof tip_error=="function"&&tip_error()}},stopRecording:function(){i.recorder.stopRecording()},stopPlayBack:function(){i.recorder.stopPlayBack()},observeLevel:function(){i.recorder.observeLevel()},stopObservingLevel:function(){i.recorder.stopObservingLevel()},observeSamples:function(){return i.recorder.observeSamples()},stopObservingSamples:function(){i.recorder.stopObservingSamples()},resize:function(e,t){i.recorder.width=e+"px",i.recorder.height=t+"px"},defaultSize:function(){i.resize(i.recorderOriginalWidth,i.recorderOriginalHeight)},show:function(){i.recorder.show()},hide:function(){i.recorder.hide()},duration:function(e){return i.recorder.duration(e||i.uploadFieldName)},getBase64:function(e){var t=i.recorder.getBase64(e);return"data:"+s+";base64,"+t},getBlob:function(e){var t=i.getBase64(e).split(",")[1];return o(t,s)},getCurrentTime:function(e){return i.recorder.getCurrentTime(e)},isMicrophoneAccessible:function(){return i.recorder.isMicrophoneAccessible()},updateForm:function(){var e=r(i.uploadFormId);i.recorder.update(e.serializeArray())},showPermissionWindow:function(e){i.resize(240,160);var t=function(){e&&e.permanent?i.recorder.permitPermanently():i.recorder.permit()};setTimeout(t,1)},configure:function(e,t,n,r){e=parseInt(e||22),t=parseInt(t||100),n=parseInt(n||0),r=parseInt(r||4e3);switch(e){case 44:case 22:case 11:case 8:case 5:break;default:throw"invalid rate "+e}if(t<0||t>100)throw"invalid gain "+t;if(n<0||n>100)throw"invalid silenceLevel "+n;if(r<-1)throw"invalid silenceTimeout "+r;i.recorder.configure(e,t,n,r)},setUseEchoSuppression:function(e){if(typeof e!="boolean")throw"invalid value for setting echo suppression, val: "+e;i.recorder.setUseEchoSuppression(e)},setLoopBack:function(e){if(typeof e!="boolean")throw"invalid value for setting loop back, val: "+e;i.recorder.setLoopBack(e)}},window.FWRecorder=i});